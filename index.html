<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Formulario Cliente - Propuesta Video</title>
<style>
  body { font-family: Arial, sans-serif; background: #f9f9f9; margin: 0; padding: 2rem; }
  h1 { text-align: center; color: #222; }
  form { max-width: 600px; margin: auto; background: white; padding: 2rem; border-radius: 8px; box-shadow: 0 2px 6px rgb(0 0 0 / 0.1); }
  label { display: block; margin-top: 1rem; font-weight: bold; color: #444; }
  input[type="text"], input[type="email"], input[type="number"], input[type="date"], textarea, select {
    width: 100%; padding: 0.5rem; margin-top: 0.3rem; border: 1px solid #ccc; border-radius: 4px;
    font-size: 1rem;
  }
  button { margin-top: 1.5rem; padding: 0.8rem 1.2rem; font-size: 1rem; background: #0069ff; color: white; border: none; border-radius: 5px; cursor: pointer; }
  button:hover { background: #0053cc; }
  .info { font-size: 0.9rem; color: #666; margin-top: 0.3rem; }
  #mensajeEnvio { margin-top: 1rem; color: green; font-weight: bold; }
</style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</head>
<body>

<h1>Formulario para Propuesta de Edición de Video</h1>

<form id="formCliente" action="https://formspree.io/f/{TU_ID_AQUI}" method="POST">
  <label for="nombre">Nombre completo</label>
  <input type="text" id="nombre" name="Nombre" required placeholder="Tu nombre">

  <label for="email">Correo electrónico</label>
  <input type="email" id="email" name="_replyto" required placeholder="Tu email">

  <label for="objetivo">¿Cuál es el objetivo principal del video?</label>
  <select id="objetivo" name="Objetivo" required>
    <option value="" disabled selected>Selecciona una opción</option>
    <option value="Promocional">Promocional</option>
    <option value="Educativo">Educativo</option>
    <option value="Redes Sociales">Redes Sociales</option>
    <option value="Interno">Interno</option>
    <option value="Otro">Otro</option>
  </select>

  <label for="publicacion">¿Dónde se publicará el video?</label>
  <input type="text" id="publicacion" name="Publicacion" required placeholder="Ej: Instagram, Youtube, web, interno">

  <label for="duracion">Duración aproximada del video (minutos)</label>
  <input type="number" id="duracion" name="Duracion" required min="1" max="60" placeholder="Ej: 3">

  <label for="fechaEntrega">¿Para cuándo necesitas el video?</label>
  <input type="date" id="fechaEntrega" name="FechaEntrega" required min="<?php echo date('Y-m-d'); ?>">

  <label for="revisiones">¿Cuántas revisiones te gustaría incluir?</label>
  <select id="revisiones" name="Revisiones" required>
    <option value="" disabled selected>Selecciona</option>
    <option value="1">1</option>
    <option value="2">2</option>
    <option value="3">3</option>
  </select>

  <label for="comentarios">Comentarios adicionales o detalles importantes</label>
  <textarea id="comentarios" name="Comentarios" rows="3" placeholder="Cuéntanos más sobre tu proyecto"></textarea>

  <input type="hidden" name="_subject" value="Nueva solicitud de propuesta de video" />
  <input type="hidden" name="_captcha" value="false" />

  <button type="submit">Enviar Propuesta</button>
  <button type="button" id="btnGenerarPDF" style="margin-left:1rem;">Generar PDF Resumen</button>
</form>

<div id="mensajeEnvio"></div>

<script>
  const { jsPDF } = window.jspdf;

  function generarPDFClienteSimple() {
    const nombre = document.getElementById("nombre").value.trim();
    const objetivo = document.getElementById("objetivo").value;
    const publicacion = document.getElementById("publicacion").value.trim();
    const duracion = document.getElementById("duracion").value;
    const fechaEntrega = document.getElementById("fechaEntrega").value;
    const revisiones = document.getElementById("revisiones").value;
    const comentarios = document.getElementById("comentarios").value.trim();
    const fechaHoy = new Date();
    const fechaLimite = new Date(fechaHoy.getTime() + 7*24*60*60*1000);

    if(!nombre || !objetivo || !publicacion || !duracion || !fechaEntrega || !revisiones) {
      alert("Por favor completa todos los campos obligatorios.");
      return;
    }

    const doc = new jsPDF();
    doc.setFontSize(18);
    doc.text("Propuesta de Edición de Video", 105, 20, { align: "center" });

    doc.setFontSize(12);
    doc.text(`Nombre: ${nombre}`, 15, 40);
    doc.text(`Objetivo: ${objetivo}`, 15, 50);
    doc.text(`Publicación: ${publicacion}`, 15, 60);
    doc.text(`Duración aproximada: ${duracion} minutos`, 15, 70);
    doc.text(`Fecha estimada de entrega: ${fechaEntrega}`, 15, 80);
    doc.text(`Revisiones incluidas: ${revisiones}`, 15, 90);
    if(comentarios) {
      doc.text("Comentarios adicionales:", 15, 100);
      const splitComments = doc.splitTextToSize(comentarios, 180);
      doc.text(splitComments, 15, 110);
    }

    doc.setFontSize(10);
    doc.setTextColor(100);
    doc.text(`Esta propuesta es válida por 7 días desde la fecha de emisión.`, 15, 280);

    doc.save(`Propuesta_Cliente_${fechaHoy.toISOString().slice(0,10)}.pdf`);
  }

  document.getElementById("btnGenerarPDF").addEventListener("click", generarPDFClienteSimple);

  // Mensaje de confirmación para envío Formspree
  document.getElementById("formCliente").addEventListener("submit", function(e) {
    e.preventDefault();
    const form = this;

    // Simple validación ya hecha por required, acá se puede ampliar
    fetch(form.action, {
      method: "POST",
      body: new FormData(form),
      headers: {
        'Accept': 'application/json'
      }
    }).then(response => {
      if (response.ok) {
        document.getElementById("mensajeEnvio").textContent = "¡Propuesta enviada con éxito! Te contactaremos pronto.";
        form.reset();
      } else {
        document.getElementById("mensajeEnvio").textContent = "Error al enviar. Por favor intenta de nuevo.";
      }
    }).catch(() => {
      document.getElementById("mensajeEnvio").textContent = "Error de conexión. Por favor intenta más tarde.";
    });
  });
</script>

</body>
</html>
